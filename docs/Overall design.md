## 项目名称 & 作者

名称：SJTU-Bookstore 书店管理系统。

作者：Zxx200611 周学信

## 程序功能概述

用命令行操作的模拟书店管理系统。支持用户管理，购买书籍，输出日志等功能。

用户功能：登录、注销、注册、修改密码、创建、删除。

图书管理功能：检索、购买、选择、修改信息、进货。

日志管理功能：财务记录查询、生成财务记录报告、生成全体员工工作报告、生成日志。

## 主体逻辑说明

用户，书籍，日志分别封装为 User、Book、Log 三个类。分别由 UserOperator、BookOperator、LogOperator 三个类进行统一管理。以上所有类存储数据交由三个数据库类 UserDatabase、BookDatabase、LogDatabase 完成。

主函数中读入各项指令，存储登录栈信息，并依据各指令调用上述类完成操作。

## 功能设计

### 用户功能

+ 登录：若用户名和密码匹配则将此用户压入登录栈，添加管理日志。
+ 注销：若登录栈非空则弹出登录栈栈顶，添加管理日志。
+ 注册：若此用户名不存在则注册用户，添加管理日志。
+ 修改密码：若用户名存在且满足修改条件则修改密码，添加管理日志。
+ 创建：若此用户名不存在且满足创建条件则注册用户，添加管理日志。
+ 删除：若此用户名存在且满足删除条件则删除用户，添加管理日志。

### 图书管理功能

+ 检索：若拥有权限，遍历所有书籍，依次比对信息，若满足则按照格式输出。
+ 购买：若拥有权限且书籍数量充足，根据 ISBN 号快速找到对应书籍，修改信息，添加财务和管理日志。
+ 选择：若拥有权限，根据 ISBN 号快速找到对应书籍，将当前账户选择的书籍设置为此书。若没有符合条件的图书则创建仅拥有 ISBN 信息的新书，添加管理日志。
+ 修改信息：若拥有权限，则修改对应 ISBN 书籍的信息，添加管理日志。
+ 进货：若拥有权限，根据 ISBN 号快速找到对应书籍，修改信息，添加财务和管理日志。

### 日志管理功能

+ 财务记录查询：若拥有权限，遍历后 count 次财务日志，计算收支。
+ 生成财务记录报告：若拥有权限，遍历财务日志，输出时间、UID、操作和收支情况。
+ 生成全体员工工作报告：若拥有权限，遍历管理日志，输出员工操作。每条包含 时间、UID、操作名和具体数据。
+ 生成日志：若拥有权限，遍历管理和财务日志，输出操作。

## 代码文件结构

+ FileOperator 类：声明于 FileOperator.h，定义于 FileOperator.cpp，实现文件操作。
+ BlockList 类：声明于 BlockList.h，定义于 BlockList.h，实现基于文件存储的块状链表类模板。
+ User & UserOperator & UserDatabase 类：声明于 User.h，定义于 User.cpp，实现用户功能。
+ Book & BookOperator & BookDatabase 类：声明于 Book.h，定义于 Book.cpp，实现图书管理功能。
+ Log & LogOperator & LogDatabase 类：声明于 Log.h，定义于 Log.cpp，实现财务和操作日志管理功能。
+ main 函数中创建三种 Operator 和 Database 的实例各一个。

## 数据库设计

### 用户数据

User：

+ 用户名（string）。
+ 密码（string）。
+ 身份码（int）。
+ 权限（int)。

UserDatabase：`BlockList<User>`。

### 书籍数据

Book：

+ ISBN 号（string）：20 字符。
+ 书名（string）：60 字符。
+ 作者（string）：60 字符。
+ 关键字（string[]）：多个，总共不超过 60 字符。
+ 库存量（int）。
+ 销售单价（int)。

BookDatabase：`BlockList<Book>`。

### 财务和操作数据

Log：

+ 操作类型（string）
+ 时间（long long）。
+ 身份码（int）。
+ 书名（string）。
+ 数量（int）。
+ ISBN 号（string）。
+ 单价（int）。

LogDatabase：`BlockList<Log>`。

## 类 & 结构体设计：

见 代码文件结构 部分。



